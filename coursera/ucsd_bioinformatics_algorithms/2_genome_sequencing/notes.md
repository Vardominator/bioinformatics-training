# stepik
## introduction
Alexander Fleming discovered penicillin. He initially struggled to isolate the antiogiotic agent from the fungus. Staphylococcus aurerus bacterium that Gause had studied in 1942 mutate into a resistant strain known as Methicillin-resistant Staphylococcus aureus (MRSA), now the learding cause of death from infections in hospitals.
A difficult problem in antibiotics research is that of sequencing newly discovered antibiotics, or determining the order of amino acids making up the antibiotic peptide. 

## how peptides are encoded by the genome 
Tyrocidine B1 is one of the many antibiotics produced by Bacillus brevis.
The *Central Dogma of Molecular Biology* states that "DNA makes RNA makes protein". According to this, a gene from a genome is first *transcribed* into a strand of RNA composed of four *ribonucleotides*: adenine, guanine, cytosine, and uracil. An RNA string is represented by {A, C, G, U}. Then, the RNA transcript is translated into an amino acid sequence of a protein. 
Computationally, all that is changing is that occurences of T are replaced with U. 
The chemical machinery goes as follows:
* During transcription, simply all occurences of T are replaced with U.
* During translation, the RNA strand is partitioned into non-overlapping 3-mers called codons.
* Each codon is converted into one of 20 amino acids via the genetic code. 
* The result is an amino acid string formed over a 20-letter alphabet. 
The geneitc code contains 64 elements.

## Where is tyrocidine encoded in the bacillus brevis genome?
There are three different ways to divide a DNA string into codons for translation, one starting at each of the first three starting positions of the string.
The three different ways of dividing a DNA string into codons are called *reading frames*. Since DNA is double-stranded, a genome has six reading frames (three on each strand). 
Tyrocidines and gramicidines are cyclic peptides.

## Dodging the central dogma
Protein translation is carried out by a molecular machine called a *ribosome*. 
Tatum reasoned that if he inhibited the ribosome, all protein production in Bacillus brevis should grind to a halt.
Fritz Lipmann demonstrated that tyrocidines and gramcidins are *non-ribosomal petides (NRPs)*, synthesized not by the ribosome, but by a giant protein called *NRP synthetase*. The enzyme pieces together antibiotic petides without any reliance on RNA or the genetic code.
NRPs have pharma applications because they have been optimized by eons of evolutions as "molecular bullets" that bacteria and fungi use to kill their enemeies. If these enemies are pathogens, researchers want to use them to develop antibacterial drugs. 

## Introduction to mass spectrometry
The *mass spectrometer* is the workhorse of peptide sequencing. It is an expensive molecular scale that shatters molecules into peices and then weights the resulting fragments. The mass spectrometer measures the mass of a molecule in *daltons (Da)*. It is approximately equal to the mass of a single nuclear particle. Thus, the mass of a molecule is simply the addition of the number of protons and neutrons found in the molecule's constituent atoms.

## Sequencing antibiotics by shattering
The collection of all fragment masses generated by the mass spectrometer is called an *experimental spectrum*. We can sequence the peptide using these fragments.

## The cyclopeptide sequencing problem
For simplicity, assume that the mass spectrometer breaks the copies of a cyclic peptide at every possible two bonds, so that the resulting experimental spectrum contains the masses of all possible linear fragments of the peptide. These are called *subpeptides*. 
Subpeptides may occur more than once if an amino acid occurs multiple times in the peptide.
Generating the theoretical spectrum of a known peptide is easy, but our aim is to solve the reverse problem of reconstructing an unknown peptide from its experimental spectrum. For now, we will assum that we are lucky enough to generate ideal spectra.

## Branch-and-Bound algorithm for cyclopeptide sequencing
* Brute force algorithms that enumerate all candidate solutions but discard large subsets of hopeless candidates by using various consistency conditions are known as *branch-and-bound algorithms*. 
* The steps consist of *branching* to increase the number of candidate solutions, following by *bounding* to remove hopeless candidates.
* Given an experimental spectrum _Spectrum_ of a cyclic peptide, a linear peptide is *consistent* with _Spectrum_ if every mass in its theoretical spectrum is contained in _Spectrum_.

## imperfect spectrum matches
* Currently a peptide's theoretical spectrum must match the experimental spectrum exactly.
* Instead we must look into scoring a peptide on how many masses its spectrum shares with the experimental spectrum.
* E.g. Score(NQEL, ExperimentalSpectrum) = 11

## scoring
* Score(Peptide, Spectrum) = number of shared masses between Cyclospectrum (Peptide) and Spectrum
* Take into account multiplicities of shared masses. The multiplicity of a mass in the experimental spectrum can be no more than that of the theoretical spectrum.

## LeaderboardCyclopeptideSequencing
* Add "0-peptide" to Leaderboard as LeaderPeptide
* Extend each peptide in Leaderboard by each of 18 different amino acid masses
* Cut low-scoring peptides from the Leaderboard (keep "top N with ties")
* Update LeaderPeptide if there is a higher scoring peptide in Leaderboard with mass = parent mass
* Eliminate all peptides with mass > parent mass
* Iterate 2-5 until Leaderboard is empty
* Return LeaderPeptide

Warning: this method is a heuristic and may miss the correct solution.

## From 18 to 100+ amino acids
* NRPs contain more non-standard amino acids because they are free from the Central Dogma
* To deal with this, bioinformaticians assume any integer between 57 and 200 can act as the mass of an amino acid (18 amino acids to 144)
* This won't work because the algorithm could give us a result with non-standard amino acids.

## Restricting amino acid alphabet
* goal: reduce the number of amino acids that we need to consider
* spectral convolution: positive difference between every pair of masses in spectrum
* What are the most frequent elements between 50 and 200?

## ConvolutionCyclopeptideSequencing
* form spectral convolution of spectrum
* take the M most frequent elements in the convolution (between 57 and 200)
* run LeaderboardCyclopeptideSequencing, forming peptides only on these M integers

## Practical considerations
### How mass spectrometer works
* ionize the peptide fragments
* sort fragments using electromagnetic field
* measure mass/charge ratio of each fragment
* determine intensity (# of ions) at each mass/charge ratio

## cyclopeptide sequencing (with errors)
* find a cyclic peptide having maximum score against an experimental spectrum
* input: a collection of integers Spectrum
* output: a cyclic peptide Peptide maximizing Score(peptide, spectrum) over all peptides Peptide with mass equal to ParentMass(spectrum) 
* adapt the original algorithm to find a peptide with maximum score 
* need to revise the step of banning candidates such that candidates with error still exist yet ensure that the number of candidate peptides does not grow out of control
* replace Peptides with Leaderboard, which holds the N highest scoring candidate peptides for further extension
* at each step we will expand the candidates in Leaderboard and eliminate the candidates that do not have a high enough score to stay on the Leaderboard
* Score(Peptide, Spectrum) only scores Peptide against Spectrum if Peptide is cyclic
* LinearScore(Peptide, Spectrum) exclude those subpeptides of Peptide that wrap around the end of the string

## LeaderboardCyclopeptideSequencing (Spectrum, N)
* Leaderboard = set with empty peptide
* while Leaderboard is not empty
  - Leaderboard = Expand(Leaderboard)
  - for each Peptide in Leaderboard
    * if Mass(Peptide) = ParentMass(Spectrum):
      - if Score(Peptide, Spectrum) > Score(LeaderPeptide, Spectrum)
        * LeaderPeptide = Peptide
    * else if Mass(Peptide) > ParentMass(Spectrum):
      - remove Peptide from Leaderboard
  - Leaderboard = Trim(Leaderboard, Spectrum, N)
return LeaderPeptide